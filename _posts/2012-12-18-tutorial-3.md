---
layout: post
title: "Sencha Touch Tutorial: メモ帳アプリを作る #3"
categories: tutorial
css: jp-post
---

<a href="/public/images/i-memo-app-tutorial2.png"><img src="/public/images/i-memo-app-tutorial2.png" alt="" title="i-memo-app-tutorial" width="601" height="261" class="aligncenter size-full wp-image-564" /></a>



<a href="http://www.adventar.org/calendars/23">Sencha Advent Calendar 2012</a> の18日目の記事です。



<a href="http://kawanoshinobu.com/2012/12/tutorial-2/">前回</a>、Sencha Cmd を使って、プロジェクトの雛形を作成しました。それでは、メモ帳アプリの開発を始めましょう。前回 app.js の launch 関数に追加した Ext.Msg.alert は不要なので消して下さい。



初めに、これから作成するメモ帳アプリの完成イメージを紹介します。



<!--more-->

<ol>
<li>メモの一覧</li>
</ol>

<ul>
<li>作成したメモを一覧表示します。</li>
<li>メモを選択すると、詳細画面に遷移します。</li>
<li>タイトルバー右上の「+」ボタンをタップすると、作成画面に遷移します。</li>
</ul>

<ol>
<li>メモの詳細</li>
</ol>

<ul>
<li>領域をタップすると編集を開始します。</li>
<li>編集を完了すると、メモデータを保存します。（ブラウザの localStrorage を利用します）</li>
<li>タイトルバー左上の「メモ」ボタンをタップすると、一覧画面に戻ります。</li>
<li>タイトルバー右上の「+」ボタンをタップすると、作成画面に遷移します。</li>
<li>下ツールバーの「ごみ箱」ボタンをタップすると、メモデータを削除し、一覧画面に戻ります。</li>
</ul>

といっても、百聞は一件に如かずですよね。完成したメモ帳アプリの動画を録画しました。



作成前に、完成形のイメージを掴んで下さい。



<iframe src="//player.vimeo.com/video/56164595" width="500" height="313" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>

<a href="http://vimeo.com/56164595">Sencha Touch 2.1 based Memo app.</a> from <a href="http://vimeo.com/kawanoshinobu">kawanoshinobu</a> on <a href="https://vimeo.com">Vimeo</a>.



<h2><strong>一覧画面を作る</strong></h2>

一覧 -> 詳細というパターンは、アプリケーションでよくあるパターンです。Sencha Touch では、このパターンのアプリを簡単に作れるよう「ナビゲーションビュー」という便利なコンポーネントを用意しています。



view ディレクトリ以下の Main.js ファイルを以下のように書き換えて下さい。



<pre><code>Ext.define('Memo.view.Main', {
    extend: 'Ext.navigation.View',    // 1
    xtype: 'main',
    requires: [
    ],
    config: {
        items: [                      // 2
            {
                title: 'メモ'          // 3
            }
        ]
    }
});
</code></pre>

「Ext.navigation.View」クラスを継承し（1）、config に items オプションを追加（2）。title に「メモ」という値を持つオブジェクトを指定します（3）。PCブラウザをリロードして、アプリを更新して下さい。



<a href="/public/images/b-t-3.png"><img src="/public/images/b-t-3.png" alt="" title="b-t-3" width="320" height="530" class="alignnone size-full wp-image-504" /></a>



タイトルバーのある画面が表示されました。続いて、リストを作りましょう。view ディレクトリ直下に、List.js というファイルを作成します。ファイルの中身を以下のように記述して下さい。



<pre><code>Ext.define('Memo.view.List', {
    extend: 'Ext.dataview.List',      // 1
    xtype: 'memolist',                // 2
    config: {
    }
});
</code></pre>

「Ext.dataview.List」クラスを継承し（1）、xtype は「memolist」と名付けます。xtype はコンポーネントの別名です。コンポーネントを利用する際に、そのコンポーネントのクラス名をフルパスで指定する代わりに使えます。また、ComponentQuery というコンポーネントを取得する機能を使う際に必要になります。



app.js の views オプションにクラスを追加ます。これにより、クラスの記述されたファイルが動的に読み込まれます。今回で言えば、view ディレクトリ以下の List.js が対象ですね。（1）



<pre><code>Ext.application({
    name: 'Memo',

    requires: [
        'Ext.MessageBox'
    ],

    views: ['Main', 'List'],           // 1
</code></pre>

view/Main.js に追加します。（1）



<pre><code>Ext.define('Memo.view.Main', {
    extend: 'Ext.navigation.View',
    xtype: 'main',
    requires: [
    ],
    config: {
        items: [
            {
                title: 'メモ',
                xtype: 'memolist'      // 1
            }
        ]
    }
});
</code></pre>

簡易的にデータを表示するため、memolist コンポーネントに以下の定義を追加してみましょう。data オプションに、配列でデータのオブジェクトを指定します。（1）



<pre><code>Ext.define('Memo.view.List', {
    extend: 'Ext.dataview.List',
    xtype: 'memolist',
    config: {
        data: [                        // 1
            { title: 'ham' },
            { title: 'egg' },
            { title: 'spam' }
        ],
        itemTpl: '{title}'
    }
});
</code></pre>

ファイルを保存して、PCブラウザでアプリをリロードしましょう。一覧にデータが表示されました。



<a href="/public/images/t-b-4.png"><img src="/public/images/t-b-4.png" alt="" title="t-b-4" width="320" height="530" class="alignnone size-full wp-image-505" /></a>



<a href="http://kawanoshinobu.com/2012/12/tutorial-4/">次回</a>は、作成フォームを作りましょう。


