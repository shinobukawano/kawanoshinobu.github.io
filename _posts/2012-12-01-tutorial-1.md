---
layout: post
title: "Sencha Touch Tutorial: メモ帳アプリを作る #1"
categories: tutorial
css: jp-post
---

<img src="/public/images/i-memo-app-tutorial2.png" alt="" title="i-memo-app-tutorial" width="601" height="261" class="aligncenter size-full wp-image-564" />

<a href="http://www.adventar.org/calendars/23">Sencha Advent Calendar 2012</a> の1日目の記事です。

ちょうど先月、Sencha Touch の新しいバージョン「2.1」が公開されました。今まで触ったことのない方は、新しく Sencha Touch を始める絶好のチャンスです！

<!--more-->

というわけで、これから数回に渡って、メモ帳アプリを開発する Sencha Touch のチュートリアルを連載します。開発環境は、Mac OS X Mountain Lion を利用しています。

<strong>12/26追記：</strong>チュートリアルはレビューされた完全なものではありません。不明点や分かりづらい点がありましたら、<a href="https://twitter.com/shinobukawano">@shinobukawano</a> 宛にお気軽にメンション頂けると嬉しいです :)



<strong>1/4追記：</strong>これから作成するアプリは、完成版のソースコードを GitHub で公開しています。サーバーのルートディレクトリに git clone して頂くと、そのままアプリを動作させることができます。



memo: <a href="https://github.com/shinobukawano/memo">https://github.com/shinobukawano/memo</a>



<h2><strong>開発に必要なツールの用意</strong></h2>

<h3>Sencha Touch 2.1 SDK</h3>

まずはライブラリをダウンロードしましょう。



<strong>Download Sencha Touch:</strong>



<a href="http://www.sencha.com/products/touch/download/">http://www.sencha.com/products/touch/download/</a>



任意のディレクトリを作って、そこにライブラリをコピーします。



<pre><code>$ mkdir apps
$ cd apps
$ cp -r ~/Downloads/sencha-touch-2 .
$ ls -al

total 0
drwxr-xr-x    3 shinobukawano  staff   102 11 23 16:12 ./
drwxr-xr-x+ 172 shinobukawano  staff  5848 11 23 16:13 ../
drwx------@  19 shinobukawano  staff   646 11 23 16:13 sencha-touch-2/
</code></pre>

<h3>Sencha Cmd</h3>

次に、Sencha Cmd をインストールします。Sencha Cmd は、Sencha Touch の開発を楽にするためのコマンドラインツールです。プロジェクトの雛形作成から、ソースコードの生成・圧縮、アプリケーションのビルドまでを行ってくれます。 インストーラは、以下のページからダウンロードして下さい。



<strong>Download Sencha Cmd:</strong>



<a href="http://www.sencha.com/products/sencha-cmd/download">http://www.sencha.com/products/sencha-cmd/download</a>



インストールが終わったら、確認のため、ターミナルで sencha コマンドを実行しましょう。以下のような表示が出れば OK です。



<pre><code>$ sencha

Sencha Cmd v3.0.0.250

Options
  * --debug, -d - Sets log level to higher verbosity
  * --plain, -p - enables plain logging output (no highlighting)
  * --quiet, -q - Sets log level to warnings and errors only
  * --sdk-path, -s - sets the path to the target framework

Categories
  * app - Perform various application build processes
  * compile - Compile sources to produce concatenated output and metadata
...
</code></pre>

<h3>WEB ブラウザ</h3>

Sencha Touch は iOS や Android の標準ブラウザで使われている「WebKit」というレンダリングエンジンを前提にしています。PC で Sencha Touch アプリを表示するためには、同じく WebKit ベースのブラウザである Google Chrome もしくは Safari を利用します。



<h3>WEB サーバー（nginx）</h3>

開発時には、依存する JavaScript ファイルを非同期通信で読み込むため、WEB サーバーを準備する必要があります。どの WEB サーバーを使っても構いませんが、本記事では、導入が簡単な「nginx」を利用します。



Homebrew (*)を使ってインストールします。以下のコマンドを実行して下さい。



<pre><code>$ brew install nginx

==&gt; Installing nginx dependency: pcre
...
==&gt; Installing nginx
...
==&gt; Summary
/usr/local/Cellar/nginx/1.2.2: 9 files, 884K, built in 91 seconds
brew install nginx  58.50s user 16.84s system 29% cpu 4:18.10 total
</code></pre>

コンソールで、以下のコマンドを実行して下さい。



<pre><code>$ nginx -t

nginx: the configuration file /usr/local/etc/nginx/nginx.conf syntax is ok
nginx: configuration file /usr/local/etc/nginx/nginx.conf test is successful
</code></pre>

nginx コマンドが実行できない場合は、/usr/local/sbin にパスが通っているかを確認して下さい。もし通っていなければ、ユーザーのホームディレクトリにある .profile ファイルにパスを追記して下さい。



<pre><code>$ cd
$ pwd

/Users/shinobukawano

$ vi .profile

...
export PATH=/usr/local/sbin:$PATH
</code></pre>

先ほどライブラリをコピーしたディレクトリを、nginx のルートディレクトリにします。設定ファイル（nginx.conf）の root を変更して下さい。



<pre><code>$ vi /usr/local/etc/nginx/nginx.conf

    location / {
-       root   html;
+       root /Users/shinobukawano/apps;
        index  index.html index.htm;
    }
</code></pre>

また、8080 ポートは他のアプリケーションで利用されることも多いので、適当な値に変更します。以下の例では、ポート番号 8080 を 3333 に変更しています。



<pre><code>    server {
-       listen       8080;
+       listen       3333;
        server_name  localhost;
</code></pre>

nginx を起動しましょう。



<pre><code>$ nginx
</code></pre>

ブラウザから、<strong>localhost:3333/sencha-touch-2</strong> にアクセスして下さい。Sencha Touch のドキュメントページが表示されれば成功です。



<img src="/public/images/sencha-doc.png" alt="" title="sencha-doc" width="100%" class="alignnone size-full wp-image-175" />

PC のログイン後に nginx を自動起動するよう LanchAgents の登録を行います。



<pre><code>$ cp /usr/local/Cellar/nginx/1.2.2/homebrew.mxcl.nginx.plist ~/Library/LaunchAgents/

$ launchctl load -w ~/Library/LaunchAgents/homebrew.mxcl.nginx.plist
</code></pre>

上記のディレクトリ名 /1.2.2/ は、インストールした nginx のバージョンによって異なるので注意して下さい。



(※)Homebrew のインストールについては割愛させて頂きます。詳しくは、公式サイト（<a href="http://mxcl.github.com/homebrew/">http://mxcl.github.com/homebrew/</a>）をご覧下さい。



<h3><strong>テキストエディタ</strong></h3>

最後に、テキストエディタを用意します。どのようなエディタでも構いませんが、最低限、ソースコードのシンタックスハイライトと、自動インデントは欲しいところです。Eclipse、NetBeans といった IDE でもよいでしょう。私は、Sublime Text というエディタがお気に入りです。



開発を始めるために必要な準備は以上です。.scss ファイルをコンパイルする際に必要なツール、ネイティブアプリケーションにパッケージングする際に必要なツールについては、別途説明します。



<h2><strong>プロジェクトの雛形を作る</strong></h2>

それではプロジェクトを始めましょう。先ほどインストールした Sencha Cmd を使って、プロジェクトの雛形を作成します。雛形の作成は、generate コマンドで行います。



ライブラリのディレクトリに移動して、以下のコマンドを実行して下さい。



<pre><code>$ pwd

/Users/shinobukawano/apps/sencha-touch-2

$ sencha generate app Memo ../memo

Sencha Cmd v3.0.0.250
[INFO ]     init-properties:
[INFO ]     init-sencha-command:
...
...
[INFO ]     generate-app:
</code></pre>

プロジェクトの雛形が作成されます。



<pre><code>$ cd ../
$ ls -al

total 0
drwxr-xr-x    4 shinobukawano  staff   136 11 23 16:14 ./
drwxr-xr-x+ 172 shinobukawano  staff  5848 11 23 16:16 ../
drwxr-xr-x   11 shinobukawano  staff   374 11 23 16:14 memo/
drwx------@  19 shinobukawano  staff   646 11 23 16:14 sencha-touch-2/
</code></pre>

ブラウザから <strong>localhost:3333/memo</strong> にアクセスしてみて下さい。



<a href="/public/images/t-1-1.png"><img src="/public/images/t-1-1.png" alt="" title="t-1-1" width="320" class="alignnone size-full wp-image-178" /></a>



Sencha Touch のアプリケーションが表示されましたね！それでは、メモ帳アプリの開発を始めましょう。



<a href="http://shinobukawano.com/2012/12/tutorial-2/">第2回</a>へ続きます。

